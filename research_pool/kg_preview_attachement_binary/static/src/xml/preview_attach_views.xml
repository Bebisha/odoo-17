<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

    <t t-name="odx.Many2ManyAttachmentPreview" owl="1">
        <div t-attf-class="oe_fileupload {{props.className ? props.className : ''}}" aria-atomic="true">
            <div class="o_attachments">
                <t t-foreach="files" t-as="file" t-key="file_index">
                   <t t-call="Many2ManyBinaryField.attachment_preview"/>
                </t>
            </div>
            <div t-if="!props.readonly" class="oe_add">
                <FileInput
                    acceptedFileExtensions="props.acceptedFileExtensions"
                    multiUpload="true"
                    onUpload.bind="onFileUploaded"
                    resModel="props.record.resModel"
                    resId="props.record.data.id or 0"
                >
                    <button class="btn btn-secondary o_attach" data-tooltip="Attach">
                        <span class="fa fa-paperclip" aria-label="Attach"/> <t t-esc="props.uploadText"/>
                    </button>
                </FileInput>
            </div>
        </div>
    </t>

    <div t-name="FieldAttachmentFileUploader.files" class="o_attachments" aria-atomic="true">
        <!-- uploaded files -->
        <t t-foreach="widget.value.data" t-as="file">
            <t t-if="!file.data.upload" t-call="FieldAttachmentFileUploader.attachment_preview" />
        </t>
        <!-- uploading files -->
        <t t-foreach="widget.uploadingFiles" t-as="file">
            <t t-set="upload" t-value="true" />
            <t t-call="FieldAttachmentFileUploader.attachment_preview" />
        </t>
    </div>

</templates>