<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <record model="ir.actions.server" id="action_open_wizard">
        <field name="name">Payment Allocations</field>
        <field name="model_id" ref="account.model_account_payment"/>
        <field name="binding_model_id" ref="account.model_account_payment"/>
        <field name="binding_view_types">form,list</field>
        <field name="state">code</field>
        <field name="code">
            action = records.action_open_payment_wizard()
        </field>
    </record>
    <record model="ir.actions.server" id="action_move_switch_move_type_allo">
        <field name="name">Allocation</field>
        <field name="model_id" ref="account.model_account_move"/>
        <field name="groups_id" eval="[(4, ref('account.group_account_invoice'))]"/>
        <field name="binding_model_id" ref="account.model_account_move"/>
        <field name="state">code</field>
        <field name="binding_view_types">form</field>
        <field name="code">
            if records:
            action = records.action_allocation()
        </field>
    </record>

    <record id="account.action_account_payments" model="ir.actions.act_window">
        <field name="name">Receipts</field>
        <field name="res_model">account.payment</field>
        <field name="view_mode">tree,kanban,form,graph</field>
        <field name="context">{
            'default_payment_type': 'inbound',
            'default_partner_type': 'customer',
            'search_default_inbound_filter': 1,
            'default_move_journal_types': ('bank', 'cash'),
            'direct_creation':True,
            }
        </field>
        <field name="view_id" ref="account.view_account_payment_tree"/>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Register a payment
            </p>
            <p>
                Payments are used to register liquidity movements. You can process those payments by your own means or
                by using installed facilities.
            </p>
        </field>
    </record>
    <record id="account.action_account_payments_payable" model="ir.actions.act_window">
        <field name="name">Vendor Payments</field>
        <field name="res_model">account.payment</field>
        <field name="view_mode">tree,kanban,form,graph,activity</field>
        <field name="context">{
            'default_payment_type': 'outbound',
            'default_partner_type': 'supplier',
            'search_default_outbound_filter': 1,
            'default_move_journal_types': ('bank', 'cash'),
            'display_account_trust': True,
            'direct_creation':True,
            }
        </field>
        <field name="view_id" ref="account.view_account_supplier_payment_tree"/>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Register a payment
            </p>
            <p>
                Payments are used to register liquidity movements. You can process those payments by your own means or
                by using installed facilities.
            </p>
        </field>
    </record>
    <record id="account_payment_inherit_inherit" model="ir.ui.view">
        <field name="name">account.payment.form.inherit</field>
        <field name="model">account.payment</field>
        <field name="inherit_id" ref="account.view_account_payment_form"/>
        <field name="arch" type="xml">
            <!--             <xpath expr="//button[@name='action_post']" position="after">-->
            <!--                 <button name="validate_payment" string="Validate" type="object" class="oe_highlight" />-->
            <!--             </xpath>-->
            <field name="ref" position="after">
                <field name="partner_invoice_id" invisible="1"/>
                <field name="kg_invoice_ids" widget="many2many_tags" force_save="1"
                       domain="[('id', 'in', partner_invoice_id)]"
                       options="{'no_quick_create':True,'no_create_edit':True}"/>
                <!--                                                    readonly="state not in draft" -->

            </field>
            <xpath expr="//group" position="after">
                <notebook>
                    <page string="Invoices">
                        <field name="payment_lines_ids">
                            <tree create="0" editable="bottom">
                                <field name="name" readonly="1" force_save="1" />
                                <field name="po_number" readonly="1" force_save="1"
                                       column_invisible="parent.payment_type == 'inbound'"/>
                                <field name="supplier_ref" readonly="1" force_save="1"
                                       column_invisible="parent.payment_type == 'inbound'"/>
                                <field name="ref" readonly="1" force_save="1"
                                       column_invisible="parent.payment_type == 'inbound'"/>
                                <field name="invoice_date" readonly="1" force_save="1"/>
                                <field name="invoice_date_due" readonly="1" force_save="1"/>
                                <field name="amount_total_signed" readonly="1" force_save="1"/>
                                <field name="amount_residual" readonly="1" force_save="1"/>
                                <field name="alrdy_allocated" string="Total allocated" readonly="1"/>
                                <field name="invoice_line_id" readonly="1" force_save="1" column_invisible="1"/>
                                <field name="inv_line_id" readonly="1" force_save="1" column_invisible="1"/>
                                <field name="allocated_amount" string="Allocate Amount" sum="Amount Total"
                                       readonly="parent.state not in ('draft','bounced')"/>
                                <field name="allocation_ids" invisible="1"/>
                            </tree>
                        </field>
                    </page>
                </notebook>
            </xpath>
        </field>
    </record>



</odoo>