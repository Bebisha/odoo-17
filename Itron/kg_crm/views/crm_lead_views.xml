<?xml version="1.0" encoding="utf-8"?>

<odoo>
    <record id="crm_reveal_lead_opportunity_form" model="ir.ui.view">
        <field name="name">crm.lead.inherited.crm</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_lead_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='action_set_won_rainbowman']" position="before">
                <button string="Create Estimation" name="create_estimation" type="object" class="oe_highlight"
                        data-hotkey="q"/>
            </xpath>
            <xpath expr="//sheet/div[@name='button_box']" position="inside">
                <button name="action_view_estimations"
                        type="object"
                        icon="fa-calculator"
                        class="oe_stat_button">
                    <field name="estimation_count" widget="statinfo" string="Estimations"/>
                </button>
            </xpath>
            <xpath expr="//field[@name='tag_ids']" position="after">
                <field name="proposed_by"/>
                <field name="date_added" readonly="1"/>
            </xpath>
            <xpath expr="//field[@name='source_id']" position="replace"/>
            <xpath expr="//group[@name='lead_priority']" position="after">
                <separator string="DEAL MILESTONE"/>
                <field name="deal_milestone_ids">
                    <tree editable="bottom">
                        <field name="name" readonly="1"/>
                        <field name="activity_id"/>
                        <field name="date"/>
                    </tree>
                </field>
                <separator string="OPPORTUNITY TIMELINES"/>
                <group>
                    <field name="demo_by"/>
                    <field name="proposed" invisible="1"/>
                    <field name="closure_by"/>
                    <label for="quarter_by"/>
                    <div class="o_row">
                        <field name="quarter_by"/>
                        <field name="year"/>
                    </div>
                    <field name="qualification_disqualification" widget="many2many_tags"/>
                </group>
                <group>
                    <field name="demo_who_id"/>
                    <field name="proposed_who_id"/>
                    <field name="closure_who_id"/>
                </group>
                <separator string="OPPORTUNITY DETAILS"/>
                <group>
                    <field name="pain_points"/>
                    <field name="modules" widget="many2many_tags"/>
                    <field name="direct"/>
                    <field name="partner_ref"/>
                </group>
                <group>
                    <field name="next_action"/>
                    <field name="next_action_date"/>
                    <field name="given_demo"/>
                    <field name="sent_proposal"/>
                </group>
                <separator string="CONTACT DETAILS"/>
                <group>
                    <field name="dm"/>
                    <field name="key_influencer"/>
                </group>
                <group>
                    <field name="contact_dm"/>
                    <field name="contact_key_instructor"/>
                    <field name="contact_gate_keeper"/>
                </group>

            </xpath>
            <xpath expr="//group[@name='lead_info']" position="before">
                <group name="lead_values" string="Lead Info" invisible="type == 'opportunity'">
                    <field name="lead_interest_id"/>
                    <field name="source_id" string="Lead Source"/>
                    <field name="gate_keeper_id"/>
                    <field name="expected_revenue"/>
                    <field name="date_deadline"/>
                    <field name="activity_status_id"/>
                    <field name="company_id" groups="base.group_multi_company"/>
                </group>
            </xpath>
            <xpath expr="//group[@name='opportunity_partner']" position="after">
                <group name="opportunity_lead_info" string="Lead Info" invisible="type=='lead'">
                    <field name="lead_interest_id"/>
                    <field name="source_id"/>
                    <field name="gate_keeper_id"/>
                    <field name="activity_status_id"/>
                    <field name="company_id" groups="base.group_multi_company"/>
                </group>
            </xpath>
            <field name="contact_name" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="function" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="website" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="tag_ids" position="after">
                <field name="website"/>
            </field>
            <field name="medium_id" position="after">
                <field name="country"/>
            </field>
            <field name="title" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>


        </field>
    </record>

    <record id="view_crm_lead_filter_kg" model="ir.ui.view">
        <field name="name">kg.crm.lead.search.custom</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.view_crm_case_leads_filter"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='saleschannel']" position="after">
                <filter string="Lead Interest" name="groupby_lead_interest" domain="[]"
                        context="{'group_by':'lead_interest_id'}"/>
                <filter string="Activity Status" name="groupby_activity_status_id" domain="[]"
                        context="{'group_by':'activity_status_id'}"/>
            </xpath>

        </field>
    </record>
    <record id="view_crm_case_opportunities_lead_filter_kg" model="ir.ui.view">
        <field name="name">kg.crm.lead.case_opportunities.search.custom</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.view_crm_case_opportunities_filter"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='saleschannel']" position="after">
                <filter string="Lead Interest" name="groupby_lead_interest" domain="[]"
                        context="{'group_by':'lead_interest_id'}"/>
                <filter string="Activity Status" name="groupby_activity_status_id" domain="[]"
                        context="{'group_by':'activity_status_id'}"/>
            </xpath>
        </field>
    </record>

    <record id="crm_lead_view_kanban_lead_inherit" model="ir.ui.view">
        <field name="name">crm.lead.view.kanban.lead.inherit</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.view_crm_lead_kanban"/>
        <field name="arch" type="xml">
            <!-- Adding custom fields inside the kanban view -->
            <xpath expr="//kanban" position="inside">
                <field name="email_from"/>
                <br/>
                <field name="phone"/>
                <br/>
            </xpath>
            <xpath expr="//div[span/field[@name='contact_name']]" position="after">
                <div>
                    <span class="o_kanban_record_subtitle">
                        <field name="modules"/>
                    </span>
                    <span class="o_kanban_record_subtitle">
                        <field name="email_from"/>
                    </span>
                    <span class="o_kanban_record_subtitle">
                        <field name="phone"/>
                    </span>
                </div>
            </xpath>
        </field>
    </record>
    <record id="custom_crm_case_kanban_view_leads" model="ir.ui.view">
        <field name="name">custom.crm.lead.kanban.lead</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_kanban_view_leads"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_id']" position="after">
                <field name="email_from"/>
                <br/>
                <field name="phone"/>
                <br/>
            </xpath>
            <xpath expr="//div[span[@class='o_text_overflow']]" position="after">
                <div>
                    <span class="o_kanban_record_subtitle">
                        <field name="modules"/>
                    </span>
                    <span class="o_kanban_record_subtitle">
                        <field name="email_from"/>
                    </span>
                    <span class="o_kanban_record_subtitle">
                        <field name="phone"/>
                    </span>
                </div>
            </xpath>
        </field>
    </record>

    <record id="custom_crm_tree_view_opportunity" model="ir.ui.view">
        <field name="name">custom.crm.lead.tree.opportunity</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_tree_view_oppor"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='recurring_revenue_monthly']" position="after">
                <field name="proposed_by" optional="show"/>
            </xpath>
            <xpath expr="//field[@name='stage_id']" position="after">
                <field name="activity_status_id" optional="show"/>
            </xpath>
        </field>
    </record>

    <record id="custom_crm_tree_view_leads" model="ir.ui.view">
        <field name="name">custom.crm.lead.tree.lead</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_tree_view_leads"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='team_id']" position="before">
                <field name="proposed_by" optional="show"/>
            </xpath>
            <xpath expr="//field[@name='source_id']" position="after">
                <field name="activity_status_id" optional="show"/>
                <field name="pain_points" optional="hide"/>
            </xpath>
        </field>
    </record>
</odoo>
