<?xml version="1.0" encoding="utf-8"?>

<odoo>
    <record id="view_picking_form_inherit_material_rt" model="ir.ui.view">
        <field name="name">view.picking.form.inherit.mr</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@class='oe_button_box']" position="after">
                <div class="ribbon ribbon-top-right" invisible="is_request == False">

                    <widget name="web_ribbon" title="Approved" bg_color="bg-success"
                            invisible="is_approve == False"/>
                    <widget name="web_ribbon" title="Rejected" bg_color="bg-danger"
                            invisible="is_reject == False"/>
                     <widget name="web_ribbon" title="Requested" bg_color="text-bg-info text-white"  invisible="is_approve == True or is_reject == True"/>
                </div>
            </xpath>

            <xpath expr="//header/field[@name='state']" position="before">
                <field name="is_request" invisible="1"/>
                <field name="is_approve" invisible="1"/>
                <field name="is_reject" invisible="1"/>
                <field name="is_verified" invisible="1"/>
                <field name="picking_type_code" invisible="1"/>
                <button name="kg_request_approve" type="object" string="Request for Approval"
                        class="oe_highlight"
                        invisible="state =='done' or is_request == True"/>
                <button name="action_stock_approve"
                        type="object"
                        string="Approve"
                        class="oe_highlight"
                        groups="kg_material_request.receipt_approval_group_user"
                        invisible="state =='done'  or is_request and approved_by or rejected_by or not is_request "/>
                <button name="action_reject_receipt"
                        type="object"
                        string="Reject"
                        groups="kg_material_request.receipt_approval_group_user"
                        invisible="state =='done'  or is_request and approved_by or rejected_by or not is_request "/>
                <button string="Update Quantity"
                        type="object"
                        name="action_update_quantity"
                        invisible="state =='done'"/>
            </xpath>
            <xpath expr="//button[@name='button_validate']" position="attributes">
                <attribute name="invisible">state in ('draft', 'confirmed', 'done', 'cancel') or not approved_by
                </attribute>
            </xpath>
            <xpath expr="//button[@name='button_validate'][@class='o_btn_validate']" position="attributes">
                <attribute name="invisible">state in ('waiting', 'assigned', 'done', 'cancel',
                    ) or not approved_by
                </attribute>
            </xpath>


            <xpath expr="//field[@name='move_ids_without_package']//tree" position="attributes">
                <attribute name="decoration-success">is_verified == True</attribute>
            </xpath>
            <xpath expr="//field[@name='move_ids_without_package']//tree" position="inside">
                <field name="is_verified" column_invisible="1"/>
                <button title="Verify" name="action_verified" type="object"
                        invisible="is_verified == True "/>
                <button title="Reset" name="action_reset" type="object" class="fa fa-reply"
                        invisible="is_verified != True"/>
            </xpath>
            <!--            <xpath expr="//field[@name='move_ids_without_package']//tree/field[@name='product_uom_qty']"-->
            <!--                   position="attributes">-->
            <!--                <attribute name="string">Request Quantity</attribute>-->
            <!--&lt;!&ndash;                <attribute name="invisible">picking_type_code == 'outgoing'</attribute>&ndash;&gt;-->
            <!--            </xpath>-->
            <xpath expr="//field[@name='move_ids_without_package']//tree/field[@name='quantity']" position="replace">
                <field name="quantity" column_invisible="1"/>
                <field name="qty" string="Entered Quantity"/>
                <field name="qty_status"/>
            </xpath>

            <xpath expr="//field[@name='move_ids_without_package']//tree/field[@name='product_id']"
                   position="before">
                <field name="default_code"/>
            </xpath>


            <xpath expr="//field[@name='origin']" position="after">
                <field name="approved_by" invisible="is_approve != True"/>
                <field name="rejected_by" invisible="is_reject != True"/>
                <field name="reject_reason" invisible="is_reject != True"/>
            </xpath>

            <!--            <xpath expr="//page[@name='note']" position="after">-->
            <!--                <page string="Reject Reason" name="reject">-->
            <!--                    <field name="reject_reason" string="Reject Reason"/>-->
            <!--                </page>-->
            <!--            </xpath>-->


            <xpath expr="//field[@name='move_ids_without_package']//tree/field[@name='product_uom_qty']"
                   position="attributes">
                <attribute name="column_invisible">not (parent.picking_type_code == 'outgoing')
                </attribute>
            </xpath>


        </field>
    </record>

    <record model="ir.ui.view" id="view_stock_quant_tree_inventory_editable_qty">
        <field name="name">stock.quant.inventory.tree.editable</field>
        <field name="model">stock.quant</field>
        <field eval="10" name="priority"/>
        <field name="arch" type="xml">
            <tree default_order="location_id, inventory_date, product_id, package_id, lot_id, owner_id"
                  decoration-warning='is_outdated' editable="bottom" create="1" edit="1" import="1"
                  js_class="inventory_report_list" sample="1">
                <header>
                    <button name="action_inventory_at_date" string="Inventory at Date" type="object"
                            invisible="((context.get('inventory_mode') and not context.get('inventory_report_mode')) or context.get('no_at_date'))"
                            class="btn-primary ms-1"
                            display="always"/>
                    <button name="stock.action_stock_inventory_adjustement_name" groups="stock.group_stock_manager"
                            type="action" string="Apply"/>
                    <button name="action_reset" type="object" string="Clear"/>
                    <button name="stock.action_stock_request_count" groups="stock.group_stock_manager" type="action"
                            string="Request a Count"/>
                    <button name="action_stock_quant_relocate" string="Relocate" type="object"
                            groups="stock.group_stock_manager" invisible="context.get('hide_location', False)"
                            context="{'action_ref': 'stock.action_view_inventory_tree'}"/>
                </header>
                <field name="create_date" column_invisible="True"/>
                <field name="write_date" column_invisible="True"/>
                <field name="id" column_invisible="True"/>
                <field name="is_outdated" column_invisible="True"/>
                <field name="sn_duplicated" column_invisible="True"/>
                <field name="tracking" column_invisible="True"/>
                <field name="inventory_quantity_set" column_invisible="True"/>
                <field name="company_id" column_invisible="True"/>
                <field name="location_id" domain="[('usage', 'in', ['internal', 'transit'])]"
                       column_invisible="context.get('hide_location', False)" readonly="id"
                       options="{'no_create': True}"/>
                <field name="storage_category_id" groups="stock.group_stock_storage_categories"
                       column_invisible="context.get('hide_location', False)" options="{'no_create': True}"
                       optional="hidden"/>
                <field name="cyclic_inventory_frequency" column_invisible="context.get('hide_location', False)"
                       options="{'no_create': True}" optional="hidden"/>
                <field name="priority" widget="priority" nolabel="1" optional="hidden"/>
                <field name="product_id" readonly="context.get('single_product', False) or id" force_save="1"
                       options="{'no_create': True}"/>
                <field name="product_categ_id" optional="hide"/>
                <button name="action_warning_duplicated_sn" type="object" invisible="not sn_duplicated"
                        title="This lot/serial number is already in another location"
                        class="btn btn-secondary text-warning float-end" icon="fa-warning"/>
                <field name="lot_id" groups="stock.group_production_lot"
                       column_invisible="context.get('hide_lot', False)"
                       readonly="tracking not in ['serial', 'lot'] or (id and (lot_id or quantity != 0))"
                       context="{'default_product_id': product_id, 'default_company_id': company_id}"
                       decoration-warning="sn_duplicated"
                       force_save="1"/>
                <field name="package_id" groups="stock.group_tracking_lot" readonly="id"/>
                <field name="owner_id" groups="stock.group_tracking_owner" readonly="id" options="{'no_create': True}"/>
                <field name="last_count_date" optional='hidden' readonly='1'/>
                <field name="available_quantity" string="Available Quantity"
                       decoration-danger="available_quantity &lt; 0" optional="hidden"/>
                <field name="quantity" optional="show" column_invisible="1" decoration-warning="quantity &lt; 0"
                       string="On Hand Quantity"/>
                <field name="product_uom_id" groups="uom.group_uom" string="UoM"/>
                <field name="inventory_quantity" widget="counted_quantity_widget"/>
                <field name="inventory_diff_quantity" string="Difference" invisible="not inventory_quantity_set"
                       decoration-muted="inventory_diff_quantity == 0"
                       decoration-danger="inventory_diff_quantity &lt; 0"
                       decoration-success="inventory_diff_quantity &gt; 0"
                       decoration-bf="inventory_diff_quantity != 0"/>
                <field name="inventory_date" optional="show"/>
                <field name="user_id" string="User" optional="show"/>
                <field name='company_id' groups="base.group_multi_company" optional="hide"/>
                <field name="lot_properties" optional="hide"/>
                <button name="action_inventory_history" type="object" class="btn btn-link text-info" icon="fa-history"
                        string="History"/>
                <button name="action_apply_inventory" groups="stock.group_stock_manager" type="object" string="Apply"
                        class="btn btn-link" icon="fa-save" invisible="not inventory_quantity_set"/>
                <button name="action_set_inventory_quantity" type="object" string="Set" class="btn btn-link"
                        icon="fa-bullseye" invisible="inventory_quantity_set"/>
                <button name="action_clear_inventory_quantity" type="object" string="Clear" class="btn text-warning"
                        icon="fa-times" invisible="not inventory_quantity_set"/>
            </tree>
        </field>
    </record>


</odoo>