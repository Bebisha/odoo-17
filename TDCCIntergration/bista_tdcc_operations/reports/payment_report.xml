<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="payment_form_header_footer">
        <div class="header">
            <t t-if="doc and 'company_id' in doc">
                <t t-set="company" t-value="doc.company_id.sudo()"/>
            </t>
            <t t-if="not doc or not 'company_id' in doc">
                <t t-set="company" t-value="res_company"/>
            </t>
            <div class="row mb8">
                <div class="col-6">
                    <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" alt="Logo" height="150"/>
                </div>
                <div class="col-6 text-right mb4">
                    <div name="company_address" class="mb4">
                        <ul class="list-unstyled">
                            <strong>
                                <li t-if="company.name">
                                    <span t-esc="company.name"/>
                                </li>
                            </strong>
                            <li t-if="company.street">
                                <span t-field="company.street"/>
                            </li>
                            <li t-if="company.state_id">
                                <span t-field="company.state_id.name"/>
                                <t t-if="company.country_id">
                                    ,
                                    <span t-esc="company.country_id.name"/>
                                </t>
                            </li>
                            <li t-if="company.zip">
                                P.O Box
                                <span t-field="company.zip"/>
                            </li>
                            <li t-if="company.phone">
                                Telephone :
                                <span t-field="company.phone"/>
                            </li>
                            <li t-if="company.email">
                                Email :
                                <span t-field="company.email"/>
                            </li>
                            <li t-if="company.vat">
                                TRN :
                                <span t-field="company.vat"/>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="article" t-att-data-oe-model="doc and doc._name" t-att-data-oe-id="doc and doc.id"
             t-att-data-oe-lang="doc and doc.env.context.get('lang')">
            <t t-raw="0"/>
        </div>
        <!--              <div class="footer" style="border-top:1px solid black;"> -->
        <!--                  <div class="pull-left" style="margin-left:100px;"> -->
        <!--                    TDCC Signature -->
        <!--                 </div> -->
        <!--                 <div class="pull-right" style="margin-right:100px;"> -->
        <!--                     Client Signature -->
        <!--                 </div> -->
        <!--             </div> -->
        <div class="footer" style="border-top:1px solid black;">
            <div class="last-page"
                 style="position: absolute; float: left; width:100%; margin-left: 10px; border-bottom: none; border: 1px solid white;">
                <div style="float: left; width:33%; padding-left: 1%; height: 80px; vertical-align: top;">
                    Client Signature
                    <br/>
                </div>
                <div style="float: left; width:33%; padding-left: 1%; height: 80px; vertical-align: top;"></div>
                <div style="float: left; width:30%; padding-left: 1%; height: 80px; vertical-align: top; text-align: right;">
                    TDCC Signature
                    <br/>
                </div>
            </div>
        </div>
    </template>
    <template id="report_payment_form_document">
        <t t-call="bista_tdcc_operations.payment_form_header_footer">
            <t t-set="doc" t-value="doc.with_context({'lang':doc.partner_id.lang})"/>
            <div class="page">
                <!--  <style>
                                        div, span {
                                            font-size: 12pt;
                                        }
                                    </style>  -->
                <div class="row">
                    <span t-esc="doc.partner_id.name"/>
                    <br/>
                    <br/>
                    <strong>Receipt</strong>
                    <br/>
                    Receipt:
                    <t t-esc="doc.name"/>
                    <br/>
                    Date:
                    <span t-esc="doc.date" t-esc-options='{" format": "MM/dd/yyyy"}'/>
                    <br/>
                    Payment Method :
                    <span t-field="doc.journal_id.name"/>
                </div>
                <table class="table table-borderless" style="margin-top:30px;">
                    <thead>
                        <tr>
                            <th style="text-align:left;">Invoice ID</th>
                            <th style="text-align:left;">Date</th>
                            <th style="text-align:left;">Description</th>
                            <th style="text-align:left;" class="text-right">Quantity</th>
                            <th style="text-align:left;" class="text-right">Amount</th>
                            <th style="text-align:left;" class="text-right">Total</th>
                            <th style="text-align:left;" class="text-right">Received</th>
                        </tr>
                    </thead>
                    <tbody class="invoice_tbody">
                        <tr t-foreach="doc.reconciled_invoice_ids" t-as="inv">
                            <td>
                                <span t-field="inv.name"/>
                            </td>
                            <td>
                                <span t-field="inv.invoice_date"/>
                            </td>
                            <td>
                                <span t-esc="','.join(line.service_type_id.name for line in inv.invoice_line_ids if line.service_type_id)"/>
                            </td>
                            <td class="text-right">
                                <span t-esc="sum(line.quantity for line in inv.invoice_line_ids)"/>
                            </td>
                            <td class="text-right">
                                <span t-esc="inv.amount_total"/>
                            </td>
                            <td class="text-right">
                                <span t-esc="inv.amount_total"/>
                            </td>
                            <td class="text-right">
                                <span t-esc="inv.amount_total - inv.amount_residual"/>
                            </td>
                        </tr>
                        <tr style="border-top:solid 2px;">
                            <td colspan="6" align="right" class="text-right">
                                <strong>Advance</strong>
                            </td>
                            <td class="text-right">
                                <span t-esc="doc.available_balance"
                                      t-options="{'widget': 'monetary', 'display_currency': doc.currency_id}"/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="6" align="right" class="text-right">
                                <strong>Receipt</strong>
                            </td>
                            <td class="text-right">
                                <span t-field="doc.amount"
                                      t-options="{'widget': 'monetary', 'display_currency': doc.currency_id}"/>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </t>
    </template>
    <template id="mail_report_payment_form_document">
        <t t-call="bista_tdcc_operations.payment_form_header_footer">
            <t t-set="doc" t-value="doc.with_context({'lang':doc.partner_id.lang})"/>
            <div class="page">
                <!--  <style>
                                        div, span {
                                            font-size: 12pt;
                                        }
                                    </style>  -->
                <div class="row">
                    <span t-esc="doc.partner_id.name"/>
                    <br/>
                    <br/>
                    <strong>Receipt</strong>
                    <br/>
                    Receipt:
                    <t t-esc="doc.name"/>
                    <br/>
                    Date:
                    <span t-esc="doc.date" t-esc-options='{" format": "MM/dd/yyyy"}'/>
                    <br/>
                    Payment Method :
                    <span t-field="doc.journal_id.name"/>
                </div>
                <table class="table table-borderless" style="margin-top:30px;">
                    <thead>
                        <tr>
                            <th style="text-align:left;">Invoice ID</th>
                            <th style="text-align:left;">Date</th>
                            <th style="text-align:left;">Description</th>
                            <th style="text-align:left;" class="text-right">Quantity</th>
                            <th style="text-align:left;" class="text-right">Amount</th>
                            <th style="text-align:left;" class="text-right">Total</th>
                            <th style="text-align:left;" class="text-right">Received</th>
                        </tr>
                    </thead>
                    <tbody class="invoice_tbody">

                        <t t-foreach="doc.invoice_ids" t-as="inv">
                            <tr>
                                <td>
                                    <span t-esc="inv.name"/>
                                </td>
                                <td>
                                    <span t-esc="inv.date"/>
                                </td>
                                <td>
                                    <t t-foreach="inv.line_ids" t-as="l">
                                        <span t-esc="l.service_type_id.name"/>
                                    </t>
                                </td>
                                <td class="text-right">
                                     <span t-esc="sum(line.quantity for line in inv.line_ids)"/>

                                </td>
                                <td class="text-right">
                                    <span t-field="doc.amount"
                                          t-options="{'widget': 'monetary', 'display_currency': doc.currency_id}"/>
                                </td>

                                <td class="text-right">
                                    <span t-esc="inv.amount_total_signed"/>
                                </td>
                                <td class="text-right">
                                    <span t-esc="inv.amount_total - inv.amount_residual"/>
                                </td>

                            </tr>
                        </t>
<!--                        <t t-foreach="doc.line_ids" t-as="l">-->
<!--                            <tr>-->
<!--                                <td>-->
<!--                                    <span t-esc="l.move_id.name"/>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <span t-esc="l.date"/>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <t t-if="l.service_type_id">-->
<!--                                        <span t-esc="l.service_type_id.name"/>-->
<!--                                    </t>-->
<!--                                </td>-->
<!--                                <td class="text-right">-->
<!--                                    <span t-esc="l.quantity"/>-->
<!--                                </td>-->
<!--                                <td class="text-right">-->
<!--                                    <span t-esc="(l.move_id.amount_total - l.move_id.amount_residual) + doc.amount"-->
<!--                                          t-options="{'widget': 'monetary', 'display_currency': doc.currency_id}"/>-->
<!--                                </td>-->

<!--                                &lt;!&ndash;                                <td class="text-right">&ndash;&gt;-->
<!--                                &lt;!&ndash;                                    &ndash;&gt;-->
<!--                                &lt;!&ndash;&lt;!&ndash;                                    <span t-esc="l.move_id.amount_total - l.move_id.amount_residual"/>&ndash;&gt;&ndash;&gt;-->
<!--                                &lt;!&ndash;                                </td>&ndash;&gt;-->
<!--                                <td class="text-right">-->
<!--                                    <span t-esc="l.move_id.amount_residual - doc.amount"-->
<!--                                          t-options="{'widget': 'monetary', 'display_currency': doc.currency_id}"/>-->
<!--                                </td>-->

<!--                                &lt;!&ndash;                                <td class="text-right">&ndash;&gt;-->
<!--                                &lt;!&ndash;                                    <span t-esc="l.move_id.amount_residual"/>&ndash;&gt;-->
<!--                                &lt;!&ndash;                                </td>&ndash;&gt;-->
<!--                                <td class="text-right">-->
<!--                                    <span t-field="doc.amount"-->
<!--                                          t-options="{'widget': 'monetary', 'display_currency': doc.currency_id}"/>-->
<!--                                </td>-->
<!--                            </tr>-->
<!--                        </t>-->

                        <tr style="border-top:solid 2px;">
                            <td colspan="6" align="right" class="text-right">
                                <strong>Advance</strong>
                            </td>
                            <td class="text-right">
                                <span t-esc="doc.available_balance"
                                      t-options="{'widget': 'monetary', 'display_currency': doc.currency_id}"/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="6" align="right" class="text-right">
                                <strong>Receipt</strong>
                            </td>
                            <td class="text-right">
                                <span t-field="doc.amount"
                                      t-options="{'widget': 'monetary', 'display_currency': doc.currency_id}"/>
                            </td>
                        </tr>


                    </tbody>

                </table>
            </div>
        </t>
    </template>


    <!--  Main Transfer Form Template  -->
    <template id="report_payment_form">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="bista_tdcc_operations.report_payment_form_document"/>
            </t>
        </t>
    </template>
    <template id="mail_report_payment_form">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="bista_tdcc_operations.mail_report_payment_form_document"/>
            </t>
        </t>
    </template>
</odoo>